# Machine learning - Processamento linguagem natural Doc2Vec

[![MIT License](https://img.shields.io/apm/l/atomic-design-ui.svg?)](https://github.com/tterb/atomic-design-ui/blob/master/LICENSEs)
[![GPLv3 License](https://img.shields.io/badge/License-GPL%20v3-yellow.svg)](https://opensource.org/licenses/)
[![AGPL License](https://img.shields.io/badge/license-AGPL-blue.svg)](http://www.gnu.org/licenses/agpl-3.0)
[![author](https://img.shields.io/badge/author-RafaelGallo-red.svg)](https://github.com/RafaelGallo?tab=repositories) 
[![](https://img.shields.io/badge/python-3.7+-blue.svg)](https://www.python.org/downloads/release/python-374/) 
[![](https://img.shields.io/badge/R-3.6.0-red.svg)](https://www.r-project.org/)
[![](https://img.shields.io/badge/ggplot2-white.svg)](https://ggplot2.tidyverse.org/)
[![](https://img.shields.io/badge/dplyr-blue.svg)](https://dplyr.tidyverse.org/)
[![](https://img.shields.io/badge/readr-green.svg)](https://readr.tidyverse.org/)
[![](https://img.shields.io/badge/ggvis-black.svg)](https://ggvis.tidyverse.org/)
[![](https://img.shields.io/badge/Shiny-red.svg)](https://shiny.tidyverse.org/)
[![](https://img.shields.io/badge/plotly-green.svg)](https://plotly.com/)
[![](https://img.shields.io/badge/XGBoost-red.svg)](https://xgboost.readthedocs.io/en/stable/#)
[![](https://img.shields.io/badge/Tensorflow-orange.svg)](https://powerbi.microsoft.com/pt-br/)
[![](https://img.shields.io/badge/Keras-red.svg)](https://powerbi.microsoft.com/pt-br/)
[![](https://img.shields.io/badge/CUDA-gree.svg)](https://powerbi.microsoft.com/pt-br/)
[![](https://img.shields.io/badge/Caret-orange.svg)](https://caret.tidyverse.org/)
[![](https://img.shields.io/badge/Pandas-blue.svg)](https://pandas.pydata.org/) 
[![](https://img.shields.io/badge/Matplotlib-blue.svg)](https://matplotlib.org/)
[![](https://img.shields.io/badge/Seaborn-green.svg)](https://seaborn.pydata.org/)
[![](https://img.shields.io/badge/Matplotlib-orange.svg)](https://scikit-learn.org/stable/) 
[![](https://img.shields.io/badge/Scikit_Learn-green.svg)](https://scikit-learn.org/stable/)
[![](https://img.shields.io/badge/Numpy-white.svg)](https://numpy.org/)
[![](https://img.shields.io/badge/PowerBI-red.svg)](https://powerbi.microsoft.com/pt-br/)

![Logo](https://img.freepik.com/free-vector/smart-industry-4-0-flat-set-with-blockchain-metaverse-3d-printing-artificial-intelligence-cloud-computing-isolated-vector-illustration_1284-81922.jpg?w=1800&t=st=1693599932~exp=1693600532~hmac=060a2f9ef0032356aed74a32afb87ab3f5bd246371097d43c2a8afa82e405cf3)

## Definição projeto

No contexto da crescente demanda por soluções de processamento de linguagem natural (PLN) mais avançadas, nosso projeto tem como objetivo explorar e aplicar técnicas de ponta para aprimorar a compreensão e o processamento do idioma humano. Para atingir esse objetivo, estamos focando no uso do modelo Doc2Vec e modelos de word embedding. Este projeto representa um passo significativo na melhoria das capacidades de PLN e nas aplicações práticas que podem resultar dessas técnicas avançadas.

## Metodologia

Para concretizar nossos objetivos, estamos empregando uma abordagem metodológica cuidadosa e abrangente. Inicialmente, coletamos e pré-processamos um grande volume de dados textuais, abrangendo diversos domínios e idiomas, a fim de criar um corpus de treinamento representativo. Em seguida, implementamos o modelo Doc2Vec, uma técnica de aprendizado de máquina que nos permite representar documentos inteiros em vetores de alta dimensão. Esse modelo nos permite capturar relações semânticas e contextuais entre palavras e frases, o que é fundamental para uma compreensão mais profunda do texto. Além disso, estamos explorando modelos de word embedding, como Word2Vec e GloVe, que mapeiam palavras em vetores densos. Esses modelos são essenciais para várias tarefas de PLN, como tradução automática, sumarização de texto e análise de sentimentos. 
Ao longo do projeto, conduzimos experimentos rigorosos para avaliar a eficácia dessas técnicas em uma variedade de tarefas de PLN, incluindo análise de sentimento, agrupamento de documentos e geração de texto automática. A avaliação cuidadosa dos resultados nos permite aprimorar continuamente nossa abordagem.

## Conclusão

Este projeto representa um passo importante no avanço do processamento de linguagem natural. O uso do modelo Doc2Vec e modelos de word embedding nos permitiu alcançar resultados notáveis na compreensão e geração de texto. Essas técnicas não apenas melhoram a precisão das tarefas de PLN, mas também têm o potencial de impulsionar uma variedade de aplicações práticas, desde assistentes virtuais mais inteligentes até sistemas de recomendação mais eficazes.
À medida que continuamos a aprimorar nossa metodologia e expandir nossa compreensão dessas técnicas, estamos confiantes de que podemos contribuir significativamente para a evolução do processamento de linguagem natural. O progresso contínuo nessa área promete revolucionar a forma como interagimos com a linguagem escrita e abre novas possibilidades para a automação de tarefas complexas envolvendo texto.

## Stack utilizada

**Programação** Python, R.

**Machine learning**: Scikit-learn.

**Leitura CSV**: Pandas.

**Análise de dados**: Seaborn, Matplotlib.

**Modelo machine learning - Regressão linear**: LGBM Regressor, CatBoost Regressor, Regression linear.

| Dataset              | Link                                                | 
| ----------------- | ---------------------------------------------------------------- |
| Abstracts of 10,000 Covid Research Papers | [Link](https://www.kaggle.com/datasets/anandhuh/covid-abstracts) |
| Personalized Medicine: Redefining Cancer Treatment  | [Link](https://www.kaggle.com/competitions/msk-redefining-cancer-treatment/overview) |
| Pfizer Vaccine | [Link](https://www.kaggle.com/datasets/gpreda/pfizer-vaccine-tweets)|
| Text mining and analysis on Cancer UK |[Link](https://www.kaggle.com/datasets/moamenibrahim/text-mining-and-analysis-on-cancer-uk) |
| WebMD Drug Reviews  |[Link](https://www.kaggle.com/datasets/rohanharode07/webmd-drug-reviews-dataset)|
| Healthcare NLP: LLMs, Transformers |[Link](https://www.kaggle.com/datasets/jpmiller/layoutlm)|
| Medical Transcriptions |[Link](https://www.kaggle.com/datasets/tboyle10/medicaltranscriptions)|


## Notebooks
| Projeto              | Link projeto                                                |
| ----------------- | ---------------------------------------------------------------- |
|Projeto|[Notebook]()|


## Variáveis de Ambiente

Para criar e gerenciar ambientes virtuais (env) no Windows, você pode usar a ferramenta venv, que vem com as versões mais recentes do Python (3.3 e posteriores). Aqui está um guia passo a passo de como criar um ambiente virtual no Windows:

1 Abrir o Prompt de Comando: Pressione a tecla Win + R para abrir o "Executar", digite cmd e pressione Enter. Isso abrirá o Prompt de Comando do Windows.

2 Navegar até a pasta onde você deseja criar o ambiente virtual: Use o comando cd para navegar até a pasta onde você deseja criar o ambiente virtual. Por exemplo:

`cd caminho\para\sua\pasta`

3 Criar o ambiente virtual: Use o comando python -m venv nome_do_seu_env para criar o ambiente virtual. Substitua nome_do_seu_env pelo nome que você deseja dar ao ambiente. 

`python -m venv myenv`

4 Ativar o ambiente virtual: No mesmo Prompt de Comando, você pode ativar o ambiente virtual usando o script localizado na pasta Scripts dentro do ambiente virtual. Use o seguinte comando:

`nome_do_seu_env\Scripts\activate`

5 Desativar o ambiente virtual: Para desativar o ambiente virtual quando você não precisar mais dele, simplesmente digite deactivate e pressione Enter no Prompt de Comando.

`myenv\Scripts\activate`

Obs: Lembre-se de que, uma vez que o ambiente virtual está ativado, todas as instalações de pacotes usando pip serão isoladas dentro desse ambiente, o que é útil para evitar conflitos entre diferentes projetos. Para sair completamente do ambiente virtual, feche o Prompt de Comando ou digite deactivate. Lembre-se também de que essas instruções pressupõem que o Python esteja configurado corretamente em seu sistema e acessível pelo comando python. Certifique-se de ter o Python instalado e adicionado ao seu PATH do sistema. Caso prefira, você também pode usar ferramentas como o Anaconda, que oferece uma maneira mais abrangente de gerenciar ambientes virtuais e pacotes em ambientes de desenvolvimento Python.

## Pacote no anaconda
Para instalar um pacote no Anaconda, você pode usar o gerenciador de pacotes conda ou o gerenciador de pacotes Python padrão, pip, que também está disponível dentro dos ambientes do Anaconda. Aqui estão as etapas para instalar um pacote usando ambos os métodos:

## Usando o Conda
1 Abra o Anaconda Navigator ou o Anaconda Prompt, dependendo da sua preferência.

2 Para criar um novo ambiente (opcional, mas recomendado), você pode executar o seguinte comando no Anaconda Prompt (substitua nome_do_seu_ambiente pelo nome que você deseja dar ao ambiente):

`conda create --name nome_do_seu_ambiente`

3 Ative o ambiente recém-criado com o seguinte comando (substitua nome_do_seu_ambiente pelo nome do ambiente que você criou):

`conda create --name nome_do_seu_ambiente`

4 Para instalar um pacote específico, use o seguinte comando (substitua nome_do_pacote pelo nome do pacote que você deseja instalar):

`conda install nome_do_pacote`


## Instalação
Instalação das bibliotecas para esse projeto no python.

```bash
  conda install pandas 
  conda install scikitlearn
  conda install numpy
  conda install scipy
  conda install matplotlib

  python==3.6.4
  numpy==1.13.3
  scipy==1.0.0
  matplotlib==2.1.2
```
Instalação do Python É altamente recomendável usar o anaconda para instalar o python. Clique aqui para ir para a página de download do Anaconda https://www.anaconda.com/download. Certifique-se de baixar a versão Python 3.6. Se você estiver em uma máquina Windows: Abra o executável após a conclusão do download e siga as instruções. 

Assim que a instalação for concluída, abra o prompt do Anaconda no menu iniciar. Isso abrirá um terminal com o python ativado. Se você estiver em uma máquina Linux: Abra um terminal e navegue até o diretório onde o Anaconda foi baixado. 
Altere a permissão para o arquivo baixado para que ele possa ser executado. Portanto, se o nome do arquivo baixado for Anaconda3-5.1.0-Linux-x86_64.sh, use o seguinte comando: chmod a x Anaconda3-5.1.0-Linux-x86_64.sh.

Agora execute o script de instalação usando.


Depois de instalar o python, crie um novo ambiente python com todos os requisitos usando o seguinte comando

```bash
conda env create -f environment.yml
```
Após a configuração do novo ambiente, ative-o usando (windows)
```bash
activate "Nome do projeto"
```
ou se você estiver em uma máquina Linux
```bash
source "Nome do projeto" 
```
Agora que temos nosso ambiente Python todo configurado, podemos começar a trabalhar nas atribuições. Para fazer isso, navegue até o diretório onde as atribuições foram instaladas e inicie o notebook jupyter a partir do terminal usando o comando
```bash
jupyter notebook
```

## Demo Modelo regressão linear simples - CatBoost Regressor 

```
import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split
from catboost import CatBoostRegressor
from sklearn.metrics import mean_squared_error
import matplotlib.pyplot as plt

# Exemplo de criação do DataFrame com os dados
data = {
    "total_gastos_educ_saude": [100, 150, 200, 250, 300, 350, 400, 450, 500],
    "pib_cresc_anual%": [2.0, 3.5, 2.8, 1.0, 0.5, 1.8, 1.2, 2.5, 3.0]
}

df = pd.DataFrame(data)

# Separando os dados em variáveis preditoras (X) e variável dependente (y)
X = df[["pib_cresc_anual%"]]
y = df["total_gastos_educ_saude"]

# Dividindo os dados em conjuntos de treino e teste
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Criando o modelo CatBoostRegressor
model = CatBoostRegressor(iterations=1000, learning_rate=0.1, depth=6, verbose=100)

# Treinando o modelo
model.fit(X_train, y_train)

# Fazendo previsões no conjunto de teste
y_pred = model.predict(X_test)

# Plotando os resultados
plt.scatter(X_test, y_test, color='blue', label='Dados reais')
plt.plot(X_test, y_pred, color='red', linewidth=2, label='Previsões')
plt.xlabel('PIB Crescimento Anual (%)')
plt.ylabel('Total Gastos Educação e Saúde')
plt.title('Previsão usando CatBoostRegressor')
plt.legend()
plt.show()
